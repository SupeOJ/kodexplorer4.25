<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23554   ||$sz>23574   ){exit;} function _kstr2($A™Üçïäâ ) { $dÂÜ¿Ì«Çç = strlen($A™Üçïäâ ); $f«…∏ÜœÌÛ = ''; $eã≥ßëÚ∏∞ = ord($A™Üçïäâ [0]) - 30; for ($aßºπ§âË— = 1; $aßºπ§âË— < $dÂÜ¿Ì«Çç; $aßºπ§âË— += 2) { if ($aßºπ§âË— + 1 < $dÂÜ¿Ì«Çç) { $f«…∏ÜœÌÛ .= chr(ord($A™Üçïäâ [$aßºπ§âË— + 1]) + $eã≥ßëÚ∏∞); $f«…∏ÜœÌÛ .= chr(ord($A™Üçïäâ [$aßºπ§âË—]) + $eã≥ßëÚ∏∞); } else { $f«…∏ÜœÌÛ .= chr(ord($A™Üçïäâ [$aßºπ§âË—]) + $eã≥ßëÚ∏∞); } } return $f«…∏ÜœÌÛ; } } $GLOBALS["\x6d\x64\x35"] = _kstr2('1QZ"'); $GLOBALS[_kstr2('1`W[\\RLP[Q\\R')] = "\152\163\157\156\137\145\156\143\157\144\145"; $GLOBALS[_kstr2('*g^bcXSWYc')._kstr2(')ZY')] = _kstr2('1`W[\\QLPR')."\157\144\145"; $GLOBALS[base64_decode('YmFzZTY0X2VuY29k')."\x65"] = "\142\141\163\145\66\64\137\145\156\143\157\144\145"; $GLOBALS[_kstr2(')^[Za\\TiZ').base64_decode('X2NvbnRlbg==').base64_decode('dHM=')] = "\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f"._kstr2(')dXiccZhi'); $GLOBALS[_kstr2(')c^VTggnV')] = "\x69\x6e\x5f\x61\x72\x72\x61\x79"; $GLOBALS["\151\155\160\154\157\144\145"] = _kstr2('+`\\_cWbX'); $GLOBALS[_kstr2('2dQX\\P[Q')] = "\x65\x78\x70\x6c\x6f\x64\x65"; $GLOBALS["\143\157\165\156\164"] = _kstr2('+bVahg'); $GLOBALS[_kstr2('0SVRO`S')] = _kstr2('.UXTQbU'); $GLOBALS["\x73\x74\x72\x74\x6f\x74\x69\x6d\x65"] = _kstr2('(jijhjec_['); $GLOBALS[_kstr2('1a`Y_[R')] = _kstr2('(jibhd['); $GLOBALS[_kstr2('0`b[W')] = base64_decode('dHJpbQ=='); $GLOBALS[_kstr2('0baM`S`Z^QOS')] = _kstr2(',feQdWd^bUSW'); $GLOBALS[base64_decode('cmF3dXJsZW5j')."\x6f\x64"."\145"] = _kstr2('1N_bdY_[R\\PRQ'); $GLOBALS[_kstr2('+hffUeg')] = _kstr2(')jhhWgi'); $GLOBALS["\x74\x69\x6d\x65"] = _kstr2('(_j[c'); $GLOBALS[_kstr2('2URQX\\K`aK').base64_decode('Yw==')._kstr2('/]^')."\164\145\156\164\163"] = _kstr2('/XUT[_Ncd')._kstr2('-TP`').base64_decode('bnRlbnRz'); $GLOBALS[_kstr2('/XUT[TNXgcbb')] = _kstr2('(_\\[b[U_njii'); $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')] = "\160\162\145\147\137\162\145\160\154\141\143\145"; $GLOBALS[_kstr2(')Zhhhd^TcihgVi')] = _kstr2(')Zhhhd^TcihgV')._kstr2('-e'); $GLOBALS[_kstr2(')Zhhhd^TcVcZb')] = base64_decode('c2Vzc2lvbl9uYW1l'); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"._kstr2('(UF7F')."\x54\x48", _kstr2(')\\pdgejVE]ir')); define(_kstr2('/>:N3A6D>N?B')."\110\101\122".base64_decode('RQ=='), _kstr2('-Xl`cafYDcR')._kstr2('/lT')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45\x4c\x46", _kstr2('-flVdDc]VnW')); define(base64_decode('S09EX1VTRVJfU0hB')."\122\105", "\173\165\163\145\162\123\150\141\162\145\175"); define(_kstr2('-@<P5DFC6CP6')."\x43\x59\x43\x4c\x45", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", _kstr2('0ciSa4`dOk')); define(_kstr2('-@<P5C8F@PA')._kstr2('2;>@;?K812'), "\173\164\162\145\145\107\162\157\165\160\123\145\154"._kstr2('2iR')); define("\113\117\104\137\107\122\117\125\120\137\122"._kstr2('-@@PE')._kstr2('28-8'), "\173\164\162\145\145\107\162\157\165"._kstr2('/0_[[l')); function _DIR_CLEAR($e—Ñäçêˆ ) { $e—Ñäçêˆ  = $GLOBALS[_kstr2(',feQdWd^b')._kstr2('+VTX')](base64_decode('XA=='), _kstr2('*#'), $e—Ñäçêˆ ); $e—Ñäçêˆ  = $GLOBALS[base64_decode('cHJlZ19yZXBsYWM=')._kstr2('-V')]("\57\134\57\53\57", base64_decode('Lw=='), $e—Ñäçêˆ ); $e’›ä¡±à‚ = $e—Ñäçêˆ ; if (isset($GLOBALS[_kstr2('.cY_Bd_')]) && $GLOBALS[_kstr2('*g]cFhc')]) { return $e—Ñäçêˆ ; } $dœ•ï””ôπ = base64_decode('Ly4uLw=='); if ($GLOBALS[_kstr2('+hffUeg')]($e—Ñäçêˆ , 0, 3) == _kstr2('0')) { $e—Ñäçêˆ  = $GLOBALS["\163\165\142\163\164\162"]($e—Ñäçêˆ , 3); } while (strstr($e—Ñäçêˆ , $dœ•ï””ôπ)) { $e—Ñäçêˆ  = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"]($dœ•ï””ôπ, _kstr2(',!'), $e—Ñäçêˆ ); } $e—Ñäçêˆ  = $GLOBALS[_kstr2('+ecZXeRcXT_XV')](_kstr2('-M   '), _kstr2('/'), $e—Ñäçêˆ ); return $e—Ñäçêˆ ; } function _DIR($cÉ”Îï◊”›) { $e—Ñäçêˆ  = _DIR_CLEAR($cÉ”Îï◊”›); $e—Ñäçêˆ  = iconv_system($e—Ñäçêˆ ); $d∏œÎ°åÌ∫ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('+b^CWgTG[l').base64_decode('cGU=')] = ''; $GLOBALS[_kstr2('2[W<P`M<TQ^')] = HOME; $GLOBALS[_kstr2('0]Y>RbO7V')._kstr2('0R')] = ''; unset($GLOBALS[_kstr2(',a]BVfS;ZV').base64_decode('U2hhcmU=')]); foreach ($d∏œÎ°åÌ∫ as $c¨‰âùèæÖ) { if ($GLOBALS[_kstr2('(kiiXhj')]($e—Ñäçêˆ , 0, $GLOBALS[_kstr2('(jibhd[')]($c¨‰âùèæÖ)) == $c¨‰âùèæÖ) { $GLOBALS[_kstr2('*c_DXhUH\\dmY')] = $c¨‰âùèæÖ; $C„êïíîªÀ = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('*#'), $e—Ñäçêˆ ); $bπˆ£™’’Ì = $C„êïíîªÀ[0]; unset($C„êïíîªÀ[0]); $Dú£–œä‡† = $GLOBALS["\151\155\160\154\157\144\145"](_kstr2('2'), $C„êïíîªÀ); $aâ•ÂÓºã = $GLOBALS[_kstr2('*lY`dXcY')]("\72", $bπˆ£™’’Ì); if ($GLOBALS[_kstr2('0]Q\\cb')]($aâ•ÂÓºã) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = $GLOBALS[_kstr2(')gib^')]($aâ•ÂÓºã[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS[_kstr2('2[W<P`M@T\\eQ')]) { case '': $e—Ñäçêˆ  = iconv_system(HOME) . $e—Ñäçêˆ ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('(eaFZjWF^')."\162\145"] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, base64_decode('Lw==')); $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; return iconv_system(USER_RECYCLE) . _kstr2(',!') . str_replace(KOD_USER_RECYCLE, '', $e—Ñäçêˆ ); case KOD_USER_SELF: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS[_kstr2('1_aZV')](HOME_PATH, _kstr2('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . _kstr2('2') . str_replace(KOD_USER_SELF, '', $e—Ñäçêˆ ); case KOD_USER_FAV: $GLOBALS[_kstr2(',a]BVfSBZ')._kstr2('-Vc')] = $GLOBALS[_kstr2('(hjc_')](KOD_USER_FAV, _kstr2('0')); $GLOBALS[_kstr2('-`\\AUeR:Y')._kstr2('0R')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('._[@TdQ@XUb')] = $GLOBALS[_kstr2('.bd]Y')](KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS["\x74\x72\x69\x6d"](KOD_GROUP_ROOT_ALL, _kstr2('2')); $GLOBALS[_kstr2('*c_DXhU=\\')._kstr2('+W')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $cêùúÆé•≥ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$cêùúÆé•≥) { return false; } owner_group_check($GLOBALS[_kstr2('+b^CWgT<[W')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($cêùúÆé•≥); $e—Ñäçêˆ  = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $Dú£–œä‡†; break; case KOD_GROUP_SHARE: $cêùúÆé•≥ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$cêùúÆé•≥) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS[_kstr2('2[W<P`M<T^')."\145"] = group_home_path($cêùúÆé•≥) . $GLOBALS[_kstr2('/^RU]VX')][base64_decode('c2V0dGluZ1N5')._kstr2('*hgaY')]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65"._kstr2('13')._kstr2(',^a')."\144\145".base64_decode('cg==')] . "\x2f"; $e—Ñäçêˆ  = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $Dú£–œä‡†; break; case KOD_USER_SHARE: $cêùúÆé•≥ = systemMember::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$cêùúÆé•≥) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('(ikh[:?')]) { $D«éçÙˆôÖ = $GLOBALS[_kstr2('/^RU]VX')][_kstr2('0O^Vb]@SZ')._kstr2('23')._kstr2('1\\_]bR1NSYba')][_kstr2('.!')][_kstr2('.SQYd^_c')]; path_role_check($D«éçÙˆôÖ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[_kstr2('*c_DXhU=\\GX')."\150\141\162"."\x65"] = $cÉ”Îï◊”›; if ($Dú£–œä‡† == '') { return $e—Ñäçêˆ ; } else { $dûπÃÏä£º = $GLOBALS[_kstr2('/gT[_S^T')]("\57", $Dú£–œä‡†); $dûπÃÏä£º[0] = iconv_app($dûπÃÏä£º[0]); $eÿâÖìÒø– = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $dûπÃÏä£º[0]); $GLOBALS[_kstr2('._[CTQXUb')._kstr2('+a<bY')] = $eÿâÖìÒø–; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141".base64_decode('cmU=')] = KOD_USER_SHARE . "\x3a" . $GLOBALS[_kstr2('(eaFZjW?^Z')] . "\x2f" . $dûπÃÏä£º[0] . "\x2f"; unset($dûπÃÏä£º[0]); if (!$eÿâÖìÒø–) { return false; } $F™èÜ“√åå = rtrim($eÿâÖìÒø–["\x70\x61\x74\x68"], base64_decode('Lw==')) . _kstr2('- ') . iconv_app($GLOBALS[base64_decode('aW1wbG9kZQ==')](_kstr2('1'), $dûπÃÏä£º)); if ($cêùúÆé•≥[_kstr2(')dgZa')] != _kstr2(')&')) { $BÌâÛ´∑Ã« = user_home_path($cêùúÆé•≥); $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $BÌâÛ´∑Ã« . rtrim($eÿâÖìÒø–[_kstr2('+Tc[g')], _kstr2('/')) . _kstr2('0'); $e—Ñäçêˆ  = $BÌâÛ´∑Ã« . $F™èÜ“√åå; } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $eÿâÖìÒø–[_kstr2('/P_Wc')]; $e—Ñäçêˆ  = $F™èÜ“√åå; } if ($eÿâÖìÒø–[_kstr2('2e`Q\\')] == _kstr2('.YVU\\')) { $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = rtrim($GLOBALS[_kstr2(')d`EYiV>]HY]')._kstr2('+T')."\x72\x65"], "\x2f"); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('(%')); } $e—Ñäçêˆ  = iconv_system($e—Ñäçêˆ ); } break; default: break; } if ($e—Ñäçêˆ  != _kstr2('/')) { $e—Ñäçêˆ  = rtrim($e—Ñäçêˆ , "\57"); if (is_dir($e—Ñäçêˆ )) { $e—Ñäçêˆ  = $e—Ñäçêˆ  . _kstr2('(%'); } } return _DIR_CLEAR($e—Ñäçêˆ ); } function _DIR_OUT($aıã”◊Ÿê∞) { if (is_array($aıã”◊Ÿê∞)) { foreach ($aıã”◊Ÿê∞["\146\151\154\145\114\151\163\164"] as $féµ‹·úÍ˘ => &$a≈ƒΩ∞·¢ù) { $a≈ƒΩ∞·¢ù[_kstr2('1N]Ua')] = preClear($a≈ƒΩ∞·¢ù["\x70\x61\x74\x68"]); } foreach ($aıã”◊Ÿê∞[_kstr2(',aXV^dW[>e')._kstr2('0b')] as $féµ‹·úÍ˘ => &$a≈ƒΩ∞·¢ù) { $a≈ƒΩ∞·¢ù["\160\141\164\150"] = preClear(rtrim($a≈ƒΩ∞·¢ù[_kstr2('-RaYe')], "\57") . _kstr2('0')); } } else { $aıã”◊Ÿê∞ = preClear($aıã”◊Ÿê∞); } return $aıã”◊Ÿê∞; } function preClear($e—Ñäçêˆ ) { $B”ÑëüÙÒ› = $GLOBALS[_kstr2('+b^CWgTG[clX')]; $E©á≠Öòﬁ = rtrim($GLOBALS[_kstr2(')d`EYiVE]Zg')], "\57"); $C∆∏ùÌ¯˘Ò = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('-`\\AUeREY')._kstr2('0g')._kstr2('-Va')]) && $GLOBALS[base64_decode('aW5fYXJyYXk=')]($GLOBALS[_kstr2(')d`EYiVI]')._kstr2(',bkW')], $C∆∏ùÌ¯˘Ò)) { return $e—Ñäçêˆ ; } if (ST == _kstr2(',ZedSW')) { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($E©á≠Öòﬁ, '', $e—Ñäçêˆ ); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $B”ÑëüÙÒ› .= _kstr2(')/') . $GLOBALS[_kstr2('0]Y>RbO7VR')] . base64_decode('Lw=='); } if (isset($GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZFNoYXJl')])) { $B”ÑëüÙÒ› = $GLOBALS[_kstr2('._[@TdQ9X')._kstr2('1@QNUR_')]; } $f«…∏ÜœÌÛ = $B”ÑëüÙÒ› . str_replace($E©á≠Öòﬁ, '', $e—Ñäçêˆ ); $f«…∏ÜœÌÛ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](base64_decode('Ly8='), "\57", $f«…∏ÜœÌÛ); return $f«…∏ÜœÌÛ; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f"."\155"._kstr2('+b`"a')._kstr2('2`_`MOU\\')._kstr2('2QU')._kstr2('*"#]d"Y]h')."\146"; function owner_group_check($có„’≈Æ¨∞) { if (!$có„’≈Æ¨∞) { show_json(LNG(_kstr2('(h]keUfedUj[')._kstr2('+\\kgf')) . $có„’≈Æ¨∞, false); } if ($GLOBALS[_kstr2('/bX^Ac^')] || isset($GLOBALS[_kstr2('1\\X=QaN.Ub')._kstr2(',ZfZ5UW]')]) && $GLOBALS[base64_decode('a29kUGF0aEF1dA==')._kstr2('-Y')."\103\150\145\143\153"] === true) { return; } $eº‡—µ®÷˘ = systemMember::userAuthGroup($có„’≈Æ¨∞); if ($eº‡—µ®÷˘ == false) { if ($GLOBALS[_kstr2('-`\\AUeREYajV')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('1\\[]L_RVZ')."\x73\x73\x69\x6f\x6e\x5f\x67\x72\x6f\x75"._kstr2('1]')), false); } else { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_SHARE) { $D«éçÙˆôÖ = $GLOBALS[_kstr2(',aUX`Y[')][_kstr2('0O^Vb]@SZ`5c]2^')._kstr2('-V').base64_decode('ZmF1bHQ=')][_kstr2('(\'')]; } } } else { $D«éçÙˆôÖ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('+Tc[gbEX_e:hbc')][$eº‡—µ®÷˘]; } path_role_check($D«éçÙˆôÖ[base64_decode('YWN0aW9ucw==')]); } function path_role_check($D«éçÙˆôÖ) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\153\157\144\120\141\164\150\101"._kstr2('2`a/TQTWO')]) && $GLOBALS["\153\157\144\120\141\164\150\101"._kstr2(')ij')._kstr2('(^')._kstr2('/W2RTZ')] === true) { return; } $DÁ¨ﬁÈÀËÇ = role_permission_arr($D«éçÙˆôÖ); $GLOBALS[_kstr2('+b^CWgTE[_b')._kstr2('14R')."\162\157\165\160\101\165\164\150"] = $DÁ¨ﬁÈÀËÇ; if (!isset($DÁ¨ﬁÈÀËÇ[ST . "\x2e" . ACT]) && ST != _kstr2(',ZedSW')) { show_json(LNG(base64_decode('bm9fcGVybWlzc2k=')."\157\156"._kstr2('.QOdS_Y^')), false); } } function role_permission_arr($aıã”◊Ÿê∞) { $f«…∏ÜœÌÛ = array(); $E€ÔÕØ∂ãÌ = $GLOBALS[_kstr2('/^RU]VX')][_kstr2('0O^Vb]@SZS2WTS\\')]; foreach ($aıã”◊Ÿê∞ as $féµ‹·úÍ˘ => $a≈ƒΩ∞·¢ù) { if (!$a≈ƒΩ∞·¢ù) { continue; } $Bﬂ∆œíÜà„ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"]("\72", $féµ‹·úÍ˘); if ($GLOBALS[_kstr2(',aU`gf')]($Bﬂ∆œíÜà„) == 2 && is_array($E€ÔÕØ∂ãÌ[$Bﬂ∆œíÜà„[0]]) && is_array($E€ÔÕØ∂ãÌ[$Bﬂ∆œíÜà„[0]][$Bﬂ∆œíÜà„[1]])) { $f«…∏ÜœÌÛ = array_merge($f«…∏ÜœÌÛ, $E€ÔÕØ∂ãÌ[$Bﬂ∆œíÜà„[0]][$Bﬂ∆œíÜà„[1]]); } } $DÀ±£ºî≠ = array(); foreach ($f«…∏ÜœÌÛ as $a≈ƒΩ∞·¢ù) { $DÀ±£ºî≠[$a≈ƒΩ∞·¢ù] = _kstr2(')&'); } return $DÀ±£ºî≠; } function check_file_writable_user($e—Ñäçêˆ ) { if (!isset($GLOBALS[_kstr2('-`\\AUeREYj')._kstr2('1]').base64_decode('ZQ==')])) { _DIR($e—Ñäçêˆ ); } $fº±∆£Ω æ = "\x65\x64\x69\x74\x6f\x72\x2e\x66\x69"."\x6c\x65\x53\x61\x76\x65"; if ($GLOBALS["\151\163\122\157\157\164"]) { return @is_writable($e—Ñäçêˆ ); } if ($GLOBALS[_kstr2('0cOVb')][$fº±∆£Ω æ] != base64_decode('MQ==')) { return false; } if ($GLOBALS[_kstr2('+b^CWgTG[').base64_decode('eXBl')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('1\\X=QaN?U\\')._kstr2('/T[a6d^0_')._kstr2('+gh[')]) && $GLOBALS[base64_decode('a29kUGF0aFJvbA==')."\145\107\162\157\165\160\101\165\164\150"][$fº±∆£Ω æ] == _kstr2('2')) { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\145"] == '' || $GLOBALS[_kstr2(')d`EYiVI]enZ')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUA==')._kstr2('1aN6UQ')]) && isset($GLOBALS[_kstr2('-`\\AUeR:Y')._kstr2('-U')]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74"."\x68\x49\x64"] == $GLOBALS[_kstr2(')d`EYiV>]Y')]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".base64_decode('cGU=')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('2[W<P`M@T\\eQ')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == _kstr2(',ZedSW')) { $e™„ªÃÕãÇ = $GLOBALS[_kstr2('+a\\')][_kstr2('.cebU')]; } else { $e™„ªÃÕãÇ = $_SESSION[_kstr2('(eaKZ[ih')]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($e™„ªÃÕãÇ); } } function spaceSizeGet($e—Ñäçêˆ , $dΩà†ßìº∫) { $F∆Ñà∆Î‡Ö = 0; if (is_file($e—Ñäçêˆ )) { $F∆Ñà∆Î‡Ö = get_filesize($e—Ñäçêˆ ); } else { if (is_dir($e—Ñäçêˆ )) { $cí∏í«ûÈ© = _path_info_more($e—Ñäçêˆ ); $F∆Ñà∆Î‡Ö = $cí∏í«ûÈ©[_kstr2('-ZdVk')]; } else { return "\x6d\x69\x73\x73"; } } return $dΩà†ßìº∫ ? $F∆Ñà∆Î‡Ö : -$F∆Ñà∆Î‡Ö; } function spaceInData($e—Ñäçêˆ ) { if ($GLOBALS[base64_decode('c3Vic3Ry')]($e—Ñäçêˆ , 0, $GLOBALS["\163\164\162\154\145\156"](HOME_PATH)) == HOME_PATH || $GLOBALS["\163\165\142\163\164\162"]($e—Ñäçêˆ , 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($BÉÖÖ¢è®∫, $dΩà†ßìº∫ = true, $bá„≈ªîÈ≈ = false, $A“˘ÿÖÜúÌ = false) { if (!system_space()) { return; } if ($bá„≈ªîÈ≈ === false) { $bá„≈ªîÈ≈ = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $A“˘ÿÖÜúÌ = $GLOBALS[base64_decode('a29kUGF0aElk')]; } $eıøÈ∏ﬁíò = spaceSizeGet($BÉÖÖ¢è®∫, $dΩà†ßìº∫); if ($eıøÈ∏ﬁíò == "\155\151\163\163") { return fasle; } if ($bá„≈ªîÈ≈ == KOD_GROUP_SHARE || $bá„≈ªîÈ≈ == KOD_GROUP_PATH) { systemGroup::spaceChange($A“˘ÿÖÜúÌ, $eıøÈ∏ﬁíò); } else { if (ST == _kstr2('0Va`OS')) { $e™„ªÃÕãÇ = $GLOBALS[_kstr2(',`[')]["\165\163\145\162"]; } else { $e™„ªÃÕãÇ = $_SESSION[base64_decode('a29kVXNlcg==')]["\165\163\145\162\111\104"]; } systemMember::spaceChange($e™„ªÃÕãÇ, $eıøÈ∏ﬁíò); } } function spaceSizeChangeRemove($BÉÖÖ¢è®∫) { spaceSizeChange($BÉÖÖ¢è®∫, false); } function spaceSizeChangeMove($A≤Í¢ÑÈ´ß, $cÈà™•ƒ¨ç) { if (isset($GLOBALS[_kstr2('2[W.PRQ^[Q')._kstr2('(WFj')._kstr2(')>]Y')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS[_kstr2('-`\\3UWVc`AVeR')._kstr2('0V')._kstr2('-U:')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"] && $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cGU=')] == $GLOBALS[_kstr2(')d`EYiVI]n')._kstr2('([f')]) { return; } spaceSizeChange($cÈà™•ƒ¨ç, false); spaceSizeChange($cÈà™•ƒ¨ç, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79"._kstr2('1R]')], $GLOBALS[base64_decode('a29kQmVmb3JlUA==')."\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($cÈà™•ƒ¨ç); } } function spaceSizeReset() { if (!system_space()) { return; } $bá„≈ªîÈ≈ = isset($GLOBALS[_kstr2('+b^CWgTG[clX')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('0^gS')] : ''; $A“˘ÿÖÜúÌ = isset($GLOBALS[_kstr2('-`\\AUeR:YU')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($bá„≈ªîÈ≈ == KOD_GROUP_SHARE || $bá„≈ªîÈ≈ == KOD_GROUP_PATH) { systemGroup::spaceChange($A“˘ÿÖÜúÌ); } else { $e™„ªÃÕãÇ = $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($e™„ªÃÕãÇ); } } function init_space_size_hook() { Hook::bind(_kstr2(')ejdaYV^;Za')._kstr2('/T1')._kstr2('-`W')._kstr2('([h'), _kstr2('*dgWUGYn]7YY\\_W')); Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69\x6c\x65\x41\x66\x74"."\145\162", base64_decode('c3BhY2VTaXplQ2hh').base64_decode('bmdl')); Hook::bind(_kstr2(',jW^bdadWe ')._kstr2('+eXi').base64_decode('ZXI=').base64_decode('RG93bmxvYWRCZQ==')._kstr2('1\\SR_'), _kstr2('-adTRDVkZ4VVY\\T')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x75\x6e\x7a"._kstr2('.`Y')._kstr2('([8e\\[h'), _kstr2('+cfVTFXm\\')."\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2(')mZaegdgZ#')."\x7a\x69\x70\x42\x65\x66\x6f\x72\x65", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2(')mZaegdgZ')."\56\160\141\164\150\103\157\160\171", _kstr2(',beUSEWl[5WWZ]U')); Hook::bind(_kstr2('1eRY]_\\_RZX')."\146\151\154\145\102\145\146\157\162\145", _kstr2('.`cSQCUjY')._kstr2('*7YY\\')._kstr2('1XP')); Hook::bind(_kstr2('0fSZ^`]`S')._kstr2('-\\^U')."\151\162\102\145\146\157\162\145", _kstr2('(fiYWI[p_9[[^Y')._kstr2('*_')); Hook::bind(_kstr2('2dQX\\^[^Q\\M')._kstr2('-e')._kstr2('+@[ibX'), _kstr2('(fiYWI[p_9[^')._kstr2('+VX^')); Hook::bind(_kstr2('.hU\\`b_bU]').base64_decode('a2Zp')._kstr2('+_')._kstr2('/0TcUaT'), _kstr2('*dgWUGYn]')."\x65".base64_decode('Q2hhbmdl')); Hook::bind(_kstr2('-iV]ac`cVaeRY')._kstr2('0]1g^T/Sb`'), "\163\160\141\143\145\123\151\172\145\103\150\141"."\x6e\x67\x65"); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('1Vg.]aS_R'), base64_decode('c3BhY2VTaXo=')._kstr2(',5WSZY`W')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\x75\x6e\x7a\x69\x70\x41\x66\x74\x65\x72", _kstr2('+cfVTFXm\\6X')._kstr2('*U\\[bY')); Hook::bind("\145\170\160\154\157\162\145\162\56\163\145\162\166\145\162"._kstr2(')d9cldaYV')._kstr2('(\\7').base64_decode('dGVy'), _kstr2('-adTRDVkZ')."\145\103\150"._kstr2('1N')._kstr2('(]d[')); Hook::bind(_kstr2('-iV]ac`cVaR')._kstr2('0Vb').base64_decode('TW92ZUJlZm9yZQ=='), _kstr2('2\\_OM?QfU/QQTO')._kstr2('-\\')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e".base64_decode('cGF0')."\150\115\157\166\145\101\146\164\145\162", base64_decode('c3BhY2VTaXplQ2hh')._kstr2('1T[:Rc\\R')); Hook::bind(_kstr2('2dQX\\^[^Q\\M')._kstr2('-YeVC`^VgV3')._kstr2('._VUb'), _kstr2(',beUSEWl[')._kstr2(',5WSZY`DW_Wha').base64_decode('ZQ==')); if ($GLOBALS["\151\156"][base64_decode('c2hpZnREZWxldGU=')]) { Hook::bind("\145\170\160\154\157\162\145\162\56\160\141"._kstr2('+[g')._kstr2('1R?\\ZRcS.Ra_'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2(',DWeWW').base64_decode('dA==')); } } function init_session() { if (!function_exists(_kstr2(',Weeea[Q`fedS')._kstr2(',f'))) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99"._kstr2('(fûf^›')._kstr2('2ß')._kstr2('.‘t¶´¨◊’™')._kstr2('+§óCC;').base64_decode('IG1pc3MgbGliKTxicg==')._kstr2('*2#£‹⁄´tóì⁄dô')._kstr2('(f^_$_d≤ÂÇ')._kstr2(')ﬁ')._kstr2('0ä')._kstr2('2‘l')."\xa6\x81\xe5\xbc\x80\xe5\x90\xaf\xe6"._kstr2(',ìöè◊,â.T')._kstr2(',!d.0db0WWe')._kstr2('0aa]W\\aX')."\x6f\x6e\x2c\x63"."\x75\x72\x6c"._kstr2('-VZiWS^edZcX_')._kstr2('0ZOR^RU').base64_decode('LHBkbyxwZG8=')._kstr2('1Z`fY^e')."\x6d\x6c\x3c\x2f"."\160\162\145\76\74\142\162\57\76"); } if (isset($_GET["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_GET[_kstr2('+VTXVffbGX^a')]); } else { if (isset($_GET[_kstr2('0QOSQaabMY]S')."\156"])) { access_token_check($_GET[_kstr2('2OMQO__`KW[')."\145\156"]); } else { @session_name(SESSION_ID); } } $fï◊ºƒ—´ã = @session_save_path(); if (class_exists(base64_decode('U2FlU3RvcmFnZQ==')) || defined(_kstr2('(7IU;F7DFC7;')) || defined(_kstr2('-6DDD@:P?2A')._kstr2(',:F6Q7')."\106\101\125\114\124") || @ini_get("\163\145\163\163\151\157\156\56\163\141\166"."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"."\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2('1\\XQ')]) { @session_save_path($fï◊ºƒ—´ã); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('1\\XQ')]) { show_tips(_kstr2('1â”“zéwÜ“`ï`RV`')._kstr2('.^_v’’âïuî’')._kstr2('.ÿ°ï§c').base64_decode('ZXNzaW9uIHc=')._kstr2('(_h[j[hhhe')."\51\74\142\162\57\76" . base64_decode('6K+35qOA5p+lcA==')._kstr2(')e]^#^cê‹')._kstr2('1“•†rr÷‘z™').base64_decode('rg==')."\54\346\237\245\347\234\213\347"."\xa3\x81\xe7\x9b\x98\xe6\x98\xaf"."\xe5\x90\xa6\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6"._kstr2('0Ñv”')."\222\250\350\257\242\346\234\215\345\212\241"._kstr2('0”').base64_decode('lYbjgII8YnIvPjxi')."\162\57"._kstr2('..') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65"._kstr2('/N')."\x70\x61\x74\x68\x3d" . $fï◊ºƒ—´ã . base64_decode('PGJyLz4=') . _kstr2(',Weeea[ `Se')."\x76\x65"._kstr2('.XO^Q\\TbU-') . @ini_get("\163\145\163\163\151\157\156\56"._kstr2('/PbTeWN]PS')._kstr2('-V]c')) . base64_decode('PGJyLz4=')); } } function access_token_check($a∫≥›ÉÉ…·) { $dÇ¬øä’¥ñ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('+Xfgga\\FZflg')._kstr2('0[S')][_kstr2('.icdc]UQ@cc_g')._kstr2('1_')._kstr2('.T')]; $dÇ¬øä’¥ñ = $GLOBALS[_kstr2('1b``O_a')]($GLOBALS["\x6d\x64\x35"](_kstr2('1\\X2Q]e\\YR_L_') . $dÇ¬øä’¥ñ), 0, 15); $c ˆ«ëè⁄€ = Mcrypt::decode($a∫≥›ÉÉ…·, $dÇ¬øä’¥ñ); if (!$c ˆ«ëè⁄€) { show_tips(_kstr2('-TRVTdd`E')."\153"."\x65\x6e\x20\x65\x72\x72\x6f\x72\x21"); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $c ˆ«ëè⁄€) { @session_name(SESSION_ID); return; } session_id($c ˆ«ëè⁄€); } function access_token_get() { $c ˆ«ëè⁄€ = session_id(); $dÇ¬øä’¥ñ = $GLOBALS[_kstr2('+bVYaZ\\')][_kstr2('([ijjd_I]io[jc')][_kstr2('-jded^VRAdd')."\x77\x6f\x72\x64"]; $dÇ¬øä’¥ñ = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS[_kstr2('*Xa)')](_kstr2('(ea;Zfneb[hUh') . $dÇ¬øä’¥ñ), 0, 15); $Fı—ÆÕ∞éÌ = Mcrypt::encode($c ˆ«ëè⁄€, $dÇ¬øä’¥ñ, 3600 * 24); return $Fı—ÆÕ∞éÌ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
